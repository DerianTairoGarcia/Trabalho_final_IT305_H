\begin{tikzpicture}
    \begin{axis}[ybar stacked,
        xlabel={Period time [h]},
        ylabel={Active power [kW]},
        ylabel near ticks,
        xlabel near ticks,
        bar width=4pt,
        tick style = {line width = 0.5, color = lightgray, 
            major tick length=4pt,minor tick length=2pt,
            minor x tick num = 3, minor y tick num =1},
        tick label style = {font=\footnotesize, xtick distance=4, ytick distance=100,
            xticklabels={01:00, 01:00, 04:00, 08:00, 12:00, 16:00, 20:00 }},
        legend style = {font=\footnotesize, at={(0.99,0.98)}, 
            legend cell align=left, line width=0.5pt, draw=lightgray},
        legend entries={BESS,E-BUS,EV},
        ymin=-350, ymax=250,
        xmin=0, xmax=25,
        axis line style = {lightgray, line width = 0.5pt},
        cycle multi list={
        lightgray, gray, black\nextlist
        fill
        }
        ]

        \addplot table 
        [col sep=comma, x = h,y=P_BESS] {./Data/firs_point.dat};
        \addplot table
        [col sep=comma, x = h, y=P_EV_1] {./Data/firs_point.dat};
        \addplot table
        [col sep=comma, x = h,y=P_EV_2] {./Data/firs_point.dat};

    \end{axis}
\end{tikzpicture}